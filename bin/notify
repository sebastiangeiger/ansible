#!/bin/sh
notify(){
  exitcode=$?
  success="$HOME/.bin/ok.png"
  fail="$HOME/.bin/fail.png"
  title="Terminal"
  if [[ $exitcode == 0 ]]; then
    image=$success
    message="... is done in `pwd`."
  else
    image=$fail
    message="... failed in `pwd`."
  fi
  terminal-notifier -message "${message}"
  if [[ `idle_time` -ge 45 ]]; then
    message="${message} (Idle for `idle_time`s)"
    curl --data "token=${PUSHOVER_TOKEN}&user=${PUSHOVER_USER}&message=${message}&title=${title}" https://api.pushover.net/1/messages.json
  fi
  (exit $exitcode) #This passes the exitcode through to the shell
}
